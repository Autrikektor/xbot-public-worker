(function(_0x3a8302,_0x3296b5){const _0x2b49c2={_0x405a41:0x1b3,_0x29b1b2:0x1a5,_0x56facc:0x1aa,_0x772a4:0x1b6,_0x49a6ee:0x1bd,_0x4073fa:0x1bf,_0x2065f0:0x1be,_0x5dfc5f:0x1a8,_0x17e7d5:0x1b1,_0x37641e:0x1b1,_0x448099:0x1b7,_0x350abe:0xd7,_0x10a5f0:0xc2,_0x1291fc:0xce,_0x118b25:0x1ad,_0x4f99fa:0x1b1,_0x28d4fd:0x1ad,_0x376639:0x1a7,_0x3fd6dc:0x1ab,_0x501904:0x1b6,_0x49cd02:0xdd,_0x28bed8:0xc9,_0x3ec4dc:0xd5,_0x2a5c92:0xdb,_0x2d1fca:0xcc,_0x1577d5:0xb1,_0x2620da:0xbb,_0x226024:0xda,_0x5306fe:0xc6,_0x3ad56e:0xd2,_0x22e3bb:0xd4,_0x4a4494:0xcb,_0x40cae3:0xc6,_0x169b93:0xcf},_0x47d9dd={_0x2ed135:0x2bb},_0x36c722={_0x1a108c:0x45},_0x56013c=_0x3a8302();function _0x1e3768(_0x4675a8,_0x255d4c,_0x3104ac,_0x5e853a){return _0x102b(_0x3104ac- -_0x36c722._0x1a108c,_0x5e853a);}function _0x5b185b(_0x9b497f,_0x399560,_0x447903,_0x414fe8){return _0x102b(_0x447903- -_0x47d9dd._0x2ed135,_0x414fe8);}while(!![]){try{const _0x5d31e2=-parseInt(_0x1e3768(_0x2b49c2._0x405a41,_0x2b49c2._0x29b1b2,_0x2b49c2._0x56facc,_0x2b49c2._0x772a4))/(0x1*0x1ae4+0x1192+-0x2c75)+-parseInt(_0x1e3768(_0x2b49c2._0x49a6ee,_0x2b49c2._0x4073fa,0x1b5,_0x2b49c2._0x2065f0))/(-0x2*0x8c9+0xc6f*-0x3+-0xdf*-0x3f)*(parseInt(_0x1e3768(_0x2b49c2._0x5dfc5f,_0x2b49c2._0x17e7d5,_0x2b49c2._0x37641e,_0x2b49c2._0x448099))/(-0x1*0x845+0x304+0x544))+-parseInt(_0x5b185b(-_0x2b49c2._0x350abe,-_0x2b49c2._0x10a5f0,-_0x2b49c2._0x1291fc,-0xce))/(0x7f*0x3a+-0x4*-0x659+-0x3626)*(parseInt(_0x1e3768(_0x2b49c2._0x118b25,_0x2b49c2._0x4f99fa,_0x2b49c2._0x28d4fd,_0x2b49c2._0x376639))/(-0x1ace+0x59*0x2+0x1*0x1a21))+parseInt(_0x1e3768(_0x2b49c2._0x772a4,_0x2b49c2._0x3fd6dc,_0x2b49c2._0x501904,0x1b5))/(0x26*-0x3e+0x1e8c+0xaa9*-0x2)+-parseInt(_0x5b185b(-_0x2b49c2._0x49cd02,-_0x2b49c2._0x28bed8,-_0x2b49c2._0x3ec4dc,-_0x2b49c2._0x2a5c92))/(0x1cba+0x593*-0x5+-0xd4)*(parseInt(_0x5b185b(-_0x2b49c2._0x2d1fca,-_0x2b49c2._0x1577d5,-0xbf,-_0x2b49c2._0x2620da))/(0x105*-0x1e+0xc8e*-0x3+-0x13*-0x398))+parseInt(_0x5b185b(-_0x2b49c2._0x226024,-_0x2b49c2._0x5306fe,-_0x2b49c2._0x3ad56e,-_0x2b49c2._0x22e3bb))/(-0x25*0x2d+0x1b1f*-0x1+-0x7*-0x4cf)+parseInt(_0x5b185b(-_0x2b49c2._0x22e3bb,-_0x2b49c2._0x4a4494,-_0x2b49c2._0x40cae3,-_0x2b49c2._0x169b93))/(-0x14ef*-0x1+0x1d69*-0x1+0x884);if(_0x5d31e2===_0x3296b5)break;else _0x56013c['push'](_0x56013c['shift']());}catch(_0x2de60a){_0x56013c['push'](_0x56013c['shift']());}}}(_0x5736,-0x8d3f+0xe*0xe177+0x25db6));function _0x5736(){const _0x565779=['mteXmJa5n2DQuM13ra','qwDLBNq','C2vHCMnO','mte1mtm2nJrjv2PdvfO','yLPJuwu','Ahr0Chm','vvvxDgO','mtu0mZqZnMH0DLfRDG','kcGOlISPkYKRkq','odG0ntCYtLD6zKrm','CMvQzwn0vw5HDq','yxHPB3m','mtv5wwzLq1y','qKT2zgy','zxHWB3j0CW','mJiYota4mdb5ExvqCui','nty4mdeXwLHssNft','lI9ZDgvHBq','yxbWBhK','zuz6CuC','nhL5qMzeva','odu2odC1nNfrzhjdyG','odbKu0f3zgi','Dg9tDhjPBMC','D3j3yM0','DgHVCML6zwq','vKjfrfG','BMHpu1m'];_0x5736=function(){return _0x565779;};return _0x5736();}function _0x102b(_0x56205f,_0x5191a5){const _0x3a2558=_0x5736();return _0x102b=function(_0x5c07b8,_0x53da08){_0x5c07b8=_0x5c07b8-(-0x11f3+0x168d+0x15a*-0x2);let _0x5705cf=_0x3a2558[_0x5c07b8];if(_0x102b['GauCIf']===undefined){var _0x2d6534=function(_0x2dafb1){const _0x2b60b0='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x43df5c='',_0x19f315='',_0x1d9390=_0x43df5c+_0x2d6534;for(let _0x7448d6=0xb*-0x259+-0x1c77+0x364a,_0x2c340f,_0x1a58cc,_0x1c42a2=0x1f*-0xe6+-0x1b58+0x3*0x1266;_0x1a58cc=_0x2dafb1['charAt'](_0x1c42a2++);~_0x1a58cc&&(_0x2c340f=_0x7448d6%(-0x127a+0xca4*0x1+-0xe*-0x6b)?_0x2c340f*(-0x1ed*0x13+-0x598+0x2a6f)+_0x1a58cc:_0x1a58cc,_0x7448d6++%(0x199f+0x1994+0x1*-0x332f))?_0x43df5c+=_0x1d9390['charCodeAt'](_0x1c42a2+(0x134a+0x4*0x18a+0x21e*-0xc))-(0x1*-0xe21+0x1119*-0x1+0x17*0x15c)!==-0x1378+-0x2*0xc0c+-0x11*-0x290?String['fromCharCode'](-0x455*-0x3+0x23c3+-0x1*0x2fc3&_0x2c340f>>(-(0x1c02+0x1bf1+0x1*-0x37f1)*_0x7448d6&-0x4df+-0x2*-0x1327+-0x2169*0x1)):_0x7448d6:-0x1*0x17b7+0x2*0xabb+0x241){_0x1a58cc=_0x2b60b0['indexOf'](_0x1a58cc);}for(let _0x506fcc=-0x2532+0x3aa+0x2188,_0x5e282c=_0x43df5c['length'];_0x506fcc<_0x5e282c;_0x506fcc++){_0x19f315+='%'+('00'+_0x43df5c['charCodeAt'](_0x506fcc)['toString'](-0x1*0x22e1+-0x1553*-0x1+-0x2*-0x6cf))['slice'](-(0x23*0x13+0x1bdf+-0x1e76));}return decodeURIComponent(_0x19f315);};_0x102b['OLszmr']=_0x2d6534,_0x56205f=arguments,_0x102b['GauCIf']=!![];}const _0x7c0366=_0x3a2558[0x1*0x19e7+0x1714+-0x30fb],_0xab804c=_0x5c07b8+_0x7c0366,_0x9a4fcc=_0x56205f[_0xab804c];if(!_0x9a4fcc){const _0x4ac33d=function(_0x3aafb1){this['lOHbQi']=_0x3aafb1,this['vkSuAo']=[0x15*-0x29+0x3*-0x23d+0xa15,0x10a*-0x11+-0x17c9+0x51*0x83,0x1*-0x1ff4+-0x2*0x1051+0x4096],this['YzoyBb']=function(){return'newState';},this['ElTzQC']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['lRwbEl']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4ac33d['prototype']['ZLdTyI']=function(){const _0x23e229=new RegExp(this['ElTzQC']+this['lRwbEl']),_0x4c6a78=_0x23e229['test'](this['YzoyBb']['toString']())?--this['vkSuAo'][0x425*-0x1+-0x1f76+0x239c]:--this['vkSuAo'][-0x11*0x139+-0x57*-0x65+0xd8a*-0x1];return this['MyIekA'](_0x4c6a78);},_0x4ac33d['prototype']['MyIekA']=function(_0x3e4310){if(!Boolean(~_0x3e4310))return _0x3e4310;return this['TiyCRD'](this['lOHbQi']);},_0x4ac33d['prototype']['TiyCRD']=function(_0x39e225){for(let _0x2ddf24=-0x9*-0xe8+0xb12*-0x3+0x190e,_0x47bf00=this['vkSuAo']['length'];_0x2ddf24<_0x47bf00;_0x2ddf24++){this['vkSuAo']['push'](Math['round'](Math['random']())),_0x47bf00=this['vkSuAo']['length'];}return _0x39e225(this['vkSuAo'][0x107*-0x21+-0x1*-0x66d+0x1b7a*0x1]);},new _0x4ac33d(_0x102b)['ZLdTyI'](),_0x5705cf=_0x102b['OLszmr'](_0x5705cf),_0x56205f[_0xab804c]=_0x5705cf;}else _0x5705cf=_0x9a4fcc;return _0x5705cf;},_0x102b(_0x56205f,_0x5191a5);}const _0x47b449=(function(){const _0x7c10be={_0x5a3d9e:0x76,_0x4ac368:0x6a,_0x2ce3ea:0x70,_0x2bb39d:0x87,_0x38cad3:0x6e,_0x269fbb:0x70,_0x31dbd9:0x1cd,_0x5a9a88:0x1cc,_0xe60116:0x1d2,_0x41c751:0x1d0,_0x511150:0x1e3,_0x5a3e17:0x1e9,_0x313fa5:0x1e7,_0x120d10:0x7e,_0x180e9a:0x6c,_0x56d8d8:0x77,_0x2289ab:0x81,_0x3158d0:0x7d},_0x894f7e={_0x83ceed:0x44,_0x411d7e:0x4e,_0x3a659f:0x53,_0x1fc9e4:0x50,_0x49ca92:0x4b,_0x40e6da:0x57,_0x1d960f:0x4b,_0x381788:0x53},_0x346fb3={_0x125d8c:0xd8,_0x39f34b:0xf0,_0xa4c74a:0x1d},_0x3c8f12={_0x5070fc:0x1a3},_0x52f8e9={_0x362adc:0x3d3},_0x21cf31={_0x1a8d00:0x274},_0x5f2ca7={};_0x5f2ca7[_0x1ec4bc(-_0x7c10be._0x5a3d9e,-_0x7c10be._0x4ac368,-0x71,-_0x7c10be._0x2ce3ea)]=function(_0x536358,_0x27be9b){return _0x536358===_0x27be9b;},_0x5f2ca7[_0x1ec4bc(-0x7b,-_0x7c10be._0x2bb39d,-_0x7c10be._0x38cad3,-_0x7c10be._0x269fbb)]=_0x580a9c(-_0x7c10be._0x31dbd9,-_0x7c10be._0x5a9a88,-_0x7c10be._0xe60116,-_0x7c10be._0x41c751),_0x5f2ca7[_0x580a9c(-_0x7c10be._0x511150,-_0x7c10be._0x511150,-_0x7c10be._0x5a3e17,-_0x7c10be._0x313fa5)]=function(_0x58bfcb,_0x6f215f){return _0x58bfcb!==_0x6f215f;};function _0x1ec4bc(_0x7de96d,_0x1aa0f0,_0x18cf68,_0x16eac9){return _0x102b(_0x7de96d- -_0x21cf31._0x1a8d00,_0x16eac9);}_0x5f2ca7[_0x1ec4bc(-0x74,-_0x7c10be._0x120d10,-_0x7c10be._0x180e9a,-_0x7c10be._0x56d8d8)]=_0x1ec4bc(-_0x7c10be._0x2289ab,-_0x7c10be._0x120d10,-_0x7c10be._0x3158d0,-0x87);const _0x25811d=_0x5f2ca7;function _0x580a9c(_0x612daf,_0x1ec954,_0x30eac6,_0x48bdaf){return _0x102b(_0x30eac6- -_0x52f8e9._0x362adc,_0x1ec954);}let _0x5959e2=!![];return function(_0x176bed,_0x49a05a){const _0x99487b={_0x4e5c3b:0xb1,_0x19233f:0xb6,_0x5493ab:0xbc,_0x2ae727:0xb5,_0x2670cd:0xb9,_0x164a72:0x3a6,_0x1147f4:0xc3,_0x33a86f:0xbc,_0xc05c3:0xba},_0x1f7569={_0x40f55e:0xfa,_0xdd1bf8:0xf7,_0x585570:0x0};function _0x128148(_0x492b6c,_0x35f81c,_0x3f88b6,_0xa05dfe){return _0x1ec4bc(_0x3f88b6-0x32d,_0x35f81c-0x1ee,_0x3f88b6-_0x3c8f12._0x5070fc,_0x35f81c);}function _0x5e7e68(_0x548d73,_0x219f9b,_0x435275,_0x37d15a){return _0x1ec4bc(_0x219f9b-_0x346fb3._0x125d8c,_0x219f9b-_0x346fb3._0x39f34b,_0x435275-_0x346fb3._0xa4c74a,_0x435275);}if(_0x25811d[_0x5e7e68(_0x894f7e._0x83ceed,_0x894f7e._0x411d7e,_0x894f7e._0x3a659f,_0x894f7e._0x1fc9e4)](_0x25811d['VBEDX'],_0x5e7e68(_0x894f7e._0x49ca92,_0x894f7e._0x40e6da,_0x894f7e._0x1d960f,_0x894f7e._0x381788)))_0x573625.error(_0x24df34);else{const _0x407a18=_0x5959e2?function(){const _0x14c0c5={_0xc36c39:0x130,_0x2f5577:0x118,_0x59a284:0x4c};function _0x510368(_0x28a34b,_0x4166fc,_0x5eabe0,_0x2f8c32){return _0x128148(_0x28a34b-_0x1f7569._0x40f55e,_0x28a34b,_0x5eabe0-_0x1f7569._0xdd1bf8,_0x2f8c32-_0x1f7569._0x585570);}function _0x33d6af(_0x2bcf0d,_0x3600f7,_0x11f3fa,_0x36146c){return _0x5e7e68(_0x2bcf0d-_0x14c0c5._0xc36c39,_0x3600f7- -_0x14c0c5._0x2f5577,_0x11f3fa,_0x36146c-_0x14c0c5._0x59a284);}if(_0x25811d[_0x33d6af(-_0x99487b._0x4e5c3b,-_0x99487b._0x19233f,-0xad,-_0x99487b._0x5493ab)](_0x25811d[_0x33d6af(-_0x99487b._0x2ae727,-0xbb,-_0x99487b._0x19233f,-_0x99487b._0x2670cd)],_0x25811d[_0x510368(0x3a2,0x39d,0x3a9,_0x99487b._0x164a72)])){if(_0x49a05a){const _0x22c38b=_0x49a05a[_0x33d6af(-_0x99487b._0x1147f4,-_0x99487b._0x33a86f,-0xb1,-_0x99487b._0xc05c3)](_0x176bed,arguments);return _0x49a05a=null,_0x22c38b;}}else _0x4d21b9.xbot.sendJobResult(_0x4d1e00,'true',_0x297790);}:function(){};return _0x5959e2=![],_0x407a18;}};}()),_0x454a83=_0x47b449(this,function(){const _0x5c086c={_0x138e6c:0x68,_0x2d8dbf:0x64,_0x30a9e7:0x4a,_0x1416fd:0x4f,_0x134158:0x50,_0x4ff262:0x19,_0x3d654f:0x20,_0x4036d9:0x12,_0x265cd8:0x1e,_0x501df0:0x22,_0x1f4817:0x1f,_0x2ed04a:0x18,_0x21061c:0x4b,_0xeb0a7b:0x53},_0x287747={_0x2e0c25:0x199},_0x34da68={_0x322839:0x200};function _0x45055c(_0x4d10c4,_0x578645,_0x3db00c,_0x1a1c75){return _0x102b(_0x1a1c75- -_0x34da68._0x322839,_0x578645);}const _0x20e073={};_0x20e073['UUWtj']='(((.+)+)+)'+'+$';const _0x53338b=_0x20e073;function _0x2f1615(_0x1cbda2,_0x4a0763,_0x3abc39,_0x44ea76){return _0x102b(_0x3abc39- -_0x287747._0x2e0c25,_0x1cbda2);}return _0x454a83[_0x2f1615(0x5b,_0x5c086c._0x138e6c,_0x5c086c._0x2d8dbf,0x67)]()[_0x2f1615(_0x5c086c._0x30a9e7,0x54,_0x5c086c._0x1416fd,_0x5c086c._0x134158)](_0x45055c(-_0x5c086c._0x4ff262,-_0x5c086c._0x3d654f,-0x19,-_0x5c086c._0x4036d9)+'+$')['toString']()['constructo'+'r'](_0x454a83)[_0x45055c(-_0x5c086c._0x265cd8,-_0x5c086c._0x501df0,-_0x5c086c._0x1f4817,-_0x5c086c._0x2ed04a)](_0x53338b[_0x2f1615(0x52,_0x5c086c._0x21061c,_0x5c086c._0xeb0a7b,_0x5c086c._0xeb0a7b)]);});_0x454a83();const axios=require(_0x53f7ff(0x11d,0x10d,0x117,0x10b));function _0x53f7ff(_0x2532aa,_0x564162,_0x139c99,_0x54e84d){const _0x23a7d6={_0x1e96ad:0xda};return _0x102b(_0x139c99- -_0x23a7d6._0x1e96ad,_0x54e84d);}const https=require(_0x53f7ff(0x108,0x10a,0x111,0x106)),SteamTotp=require('steam-totp'),xbsteam=require(_0x53f7ff(0x11a,0x126,0x11d,0x11f)),_0xa225f9={};function _0x160c10(_0x10f045,_0x58bf0a,_0x1356bf,_0x31be39){const _0x51a08c={_0x4a7fbc:0x1a9};return _0x102b(_0x1356bf- -_0x51a08c._0x4a7fbc,_0x10f045);}_0xa225f9[_0x160c10(0x44,0x45,0x47,0x39)+_0x53f7ff(0x12c,0x133,0x125,0x11b)]=![];const httpsAgent=new https[(_0x53f7ff(0x103,0x10c,0x10d,0x118))](_0xa225f9);module[_0x160c10(0x52,0x57,0x4b,0x55)]=class xbot{xbot_apiurl=global.xbot_apiurl;prefix='[xbot.gg] ';axiosconfig={httpsAgent:httpsAgent,withCredentials:true,baseURL:this.xbot_apiurl,timeout:10000,headers:{'Authorization':`Bearer ${global.data.apiKey}`,'Accept':'application/json','X-Requested-With':'XMLHttpRequest','X-Bot-Version':global.data.version}};axios=null;xbot_session=null;axios=axios.create(this.axiosconfig);auth(){return new Promise((resolve,reject)=>{this.axios.post('auth',{login:global.data.username}).then(function(response){global.xbot.xbot_session=response.data.session_key;if(response.data.status==0){global.xbot.xbot_loggedIn=true;}resolve(response.data.session_key);console.log(global.xbot.prefix+'Успешно авторизован');}).catch(function(error){reject(error);});});}xbot_loggedIn=false;lastsentauthkey='';async ping(authkey){return await new Promise(async(resolve,reject)=>{this.lastsentauthkey=authkey;this.axios.post('ping',{login:global.data.username,session_key:global.xbot.xbot_session,authkey:authkey}).then(function(response){resolve(response);}).catch(async function(error){global.xbot.xbot_loggedIn=false;console.error('Error:',error);reject(error);});});}invcontexts=[];updateOrdersAndListings(data){return new Promise((resolve,reject)=>{this.axios.post('updateOrdersAndListings',{login:global.data.username,session_key:global.xbot.xbot_session,listings:data.listings,listings_on_hold:data.listings_on_hold,listings_to_confirm:data.listings_to_confirm,buy_orders:data.buy_orders}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}updateAccountData(user,contexts,wallet){return new Promise((resolve,reject)=>{user._community=null;user.session_key=null;if(contexts!==undefined){this.invcontexts=Object.keys(contexts);}this.axios.post('updateAccountData',{login:global.data.username,session_key:this.xbot_session,account:user,inventoryContexts:contexts,wallet:wallet}).then(function(response){resolve(response);}).catch(function(error){reject(error);console.error('Error:',error.response.data);});});}updateInventory(appid,inventory){return new Promise((resolve,reject)=>{this.axios.post('updateInventory',{login:global.data.username,session_key:this.xbot_session,inventory:inventory,appid:appid}).catch(function(error){reject(error);console.error('Error:',error.response.data);}).then(function(data){resolve(data);});});}userdata=null;getJobs(){return new Promise((resolve,reject)=>{this.axios.post('getJobs',{login:global.data.username,session_key:this.xbot_session}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}sellHook(jobId,data){return new Promise((resolve,reject)=>{this.axios.post('sellItemHook/'+jobId,{login:global.data.username,session_key:this.xbot_session,data:data}).then(function(response){console.log(response.data);resolve(response.data);}).catch(function(error){reject(error);});});}sendJobResult(job,status,result){try{console.log('['+status+'] sending job result '+job.id);this.axios.post('jobResult/'+job.id,{login:global.data.username,session_key:this.xbot_session,jobId:job.id,status:status,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log('Произошла ошибка при отправке статуса задания '+job.id);}}customLog(code,message){try{this.axios.post('customLog',{login:global.data.username,session_key:this.xbot_session,code:code,message:message}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log(ex);console.log('Произошла ошибка при отправке лога ');}}history(result){this.axios.post('updateLatestHistory',{login:global.data.username,session_key:this.xbot_session,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}async processJob(job){return await new Promise(async(resolve,reject)=>{try{switch(job.type){case 1:await global.xbsteam.getItemEconomics(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).catch(function(ex){console.log(ex);}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 2:const j=await new Promise(async(resolve2,reject2)=>{resolve2(await global.sc.getUserInventory(global.xbot.userdata.steamID,job.context.appid,job.context.contextid,false,function(e,inv,currency){if(e){reject2(e);return;}resolve2(inv);}));}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 3:await global.xbsteam.getItemPriceHistory(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',{priceHistory:r});}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 4:await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 5:await global.xbsteam.getItemMarketNameId(job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 6:await global.xbsteam.checkAbilityToTrade(job.context.partner,job.context.token).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'true',{error:e.message});});break;case 7:await global.xbsteam.sendTradeOffer(job.context.steam_id,job.context.items,job.context.partner,job.context.token).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 8:await global.xbsteam.setConfirmationStatus(job.context.confirmation_id,job.context.key,job.context.accept).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 9:await global.xbsteam.cancelTradeOffer(job.context.trade_offer_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 10:await global.xbsteam.acceptTradeOffer(job.context.trade_offer_id,job.context.partner).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 11:await global.xbsteam.updateTradeOffers().then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 12:if(job.context.analyze===true){const data=await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id);var hook=this.sellHook(job.id,data);if(hook.price!==undefined&&hook.price>0){job.context.price=hook.price;}}await global.xbsteam.sellItem(job.context.appid,job.context.contextid,job.context.assetid,job.context.amount,job.context.price).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 13:await global.xbsteam.cancelSellListing(job.context.listingId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 14:await global.xbsteam.createBuyOrder(job.context.currency,job.context.appid,job.context.market_hash_name,job.context.price_total,job.context.quantity,job.context.billing_state,job.context.save_my_address).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 15:await global.xbsteam.cancelBuyOrder(job.context.orderId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 16:await global.xbsteam.getMarketHistory(job.context.offset,job.context.limit).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;default:console.log('unknown job type');console.log(job.type);new Error('Unknown job type');break;}}catch(ex){this.sendJobResult(job,false,null);console.log(ex);global.sc.wait();console.log('Произошла ошибка при обработке задания #'+job.id);}resolve();});}async sendConfirmations(){const self=this;global.sc.wait();await global.xbsteam.getConfirmations().then(function(data){self.axios.post('updateConfirmations',{login:global.data.username,session_key:global.xbot.xbot_session,confirmations:data}).then(function(response){console.log('Отправлено '+data.length+' Confirmations');}).catch(function(error){console.log(error.message);});}).catch(function(e){console.log('Произошла ошибка при проверке аунтентификатора');});}async processInventory(){return await new Promise(async(resolve,reject)=>{console.log(this.prefix+'Обновляю инвентарь');await global.sc.wait();const arr=await global.xbsteam.getInventoryContexts(global.sc.steamID);const data=arr[0];const wallet=arr[1];global.xbot.updateAccountData(global.xbot.userdata,data,wallet);const invcontexts=Object.keys(data);for(const invc of invcontexts){await new Promise(async(resolve2,reject2)=>{await global.sc.wait();global.sc.getUserInventory(global.xbot.userdata.steamID,invc,2,false,function(e,inv,currency){if(e){reject2(e);return;}global.xbot.updateInventory(invc,inv);resolve2(data);});}).catch(function(e){console.log(e);}).then(function(data){console.log(global.xbot.prefix+invc+' updated');});}resolve();});}loop(tickCounter){return new Promise(async(resolve,reject)=>{try{if(!this.xbot_loggedIn){console.log(this.prefix+'Попытка авторизации');await this.auth().catch(await function(e){return new Promise(async resolve2=>{console.log(e.response?.data);console.log('Ошибка авторизации. Проверьте API ключ');await new Promise(resolve2=>setTimeout(resolve,global.data.tickDelay*2));resolve2();});});if(this.xbot_loggedIn){console.log(this.prefix+'Обновляю данные пользователя');await global.sc.wait();await global.sc.getSteamUser(sc.steamID,(err,user)=>{if(err){console.error('steam: Ошибка при получении информации о пользователе:');this.xbot_loggedIn=false;}else{user.steamID64=user.steamID.getSteamID64();global.xbot.userdata=user;}});}}if(this.xbot_loggedIn&&global.xbot.userdata!==null){if(tickCounter%global.data.ticks.checkConfirmations===0||global.data.needToSendConfirmations===true){console.log(this.prefix+'Проверяю аутентификатор');await this.sendConfirmations();global.data.needToSendConfirmations=false;await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}let authkey=SteamTotp.getAuthCode(global.data.sharedSecret);if(tickCounter%global.data.ticks.ping===0||this.lastsentauthkey!==authkey){await this.ping(authkey);}if(tickCounter%global.data.ticks.sendInventory===0||tickCounter===2){await this.processInventory();}if(tickCounter%global.data.ticks.sendOrders===0||tickCounter===2){console.log(this.prefix+'Проверяю ордера');await global.sc.wait();await global.xbsteam.getOrders().then(function(data){global.xbot.updateOrdersAndListings(data);});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}if(tickCounter%global.data.ticks.lastHistory===0||tickCounter===2){console.log(this.prefix+'Обновляю историю операций');var a=await global.xbsteam.getMarketHistory(0,100);this.history(a);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}const jobsResponse=await this.getJobs();const jobs=jobsResponse.jobs;console.log(this.prefix+'Получено '+jobs.length+' заданий');for(const job of jobs){await this.processJob(job);}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));resolve();}catch(ex){console.log(ex);reject(ex);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*25));}});}};