(function(_0x345d12,_0x4c906b){const _0x42d586={_0x51eb9f:0x76,_0x107f22:0x8c,_0x1f0186:0x7d,_0x117af3:0x7f,_0xfa7fcc:0x7a,_0x2e6818:0x7e,_0x35e8fb:0x82,_0x1c3f92:0x70,_0x5dc2a4:0x73,_0x34f62f:0x78,_0x4696b8:0x84,_0x5aaddb:0x7c,_0x1b3f89:0x10e,_0xb205d3:0x108,_0x30a3ce:0x110,_0x38f286:0x102,_0x3d53e6:0xf4,_0x2d034a:0xff,_0x508b13:0xf6,_0x1191ac:0xfa,_0x2e053b:0x84,_0x59edb9:0x86,_0x239cf6:0x8c,_0x920932:0x94,_0x1c6988:0x8b,_0x33cae0:0x8a},_0x2febbd={_0x5e8c2a:0x2c0},_0x262f8f={_0x54b885:0x146},_0x1520b4=_0x345d12();function _0x36d3c1(_0x56e954,_0x1e520f,_0xf60834,_0xa6b30d){return _0x11f8(_0xf60834- -_0x262f8f._0x54b885,_0x1e520f);}function _0x3811c4(_0x38e731,_0x2d8a6c,_0x56a1bd,_0x43eaf4){return _0x11f8(_0x2d8a6c- -_0x2febbd._0x5e8c2a,_0x43eaf4);}while(!![]){try{const _0x3404e1=parseInt(_0x36d3c1(_0x42d586._0x51eb9f,_0x42d586._0x107f22,_0x42d586._0x1f0186,_0x42d586._0x117af3))/(-0x1*0x1597+-0x1db*0x11+0x1*0x3523)*(-parseInt(_0x36d3c1(_0x42d586._0xfa7fcc,_0x42d586._0x117af3,_0x42d586._0x2e6818,_0x42d586._0x35e8fb))/(-0x1*-0xff1+0x3df*-0x3+-0x4f*0xe))+parseInt(_0x36d3c1(_0x42d586._0x51eb9f,_0x42d586._0x1c3f92,0x7f,_0x42d586._0x5dc2a4))/(0x2494+0x1caa+-0x413b*0x1)*(parseInt(_0x36d3c1(0x8a,_0x42d586._0x34f62f,_0x42d586._0x4696b8,_0x42d586._0x5aaddb))/(0x71*-0x23+0x7c4+0x7b3))+parseInt(_0x3811c4(-_0x42d586._0x1b3f89,-_0x42d586._0xb205d3,-_0x42d586._0x30a3ce,-_0x42d586._0x38f286))/(0x24c3+0x51f*-0x2+-0x1a80)+-parseInt(_0x3811c4(-0x100,-0xf7,-0xfa,-_0x42d586._0x3d53e6))/(-0x1f28+0x19d4+0x55a)+parseInt(_0x3811c4(-0xf5,-_0x42d586._0x2d034a,-_0x42d586._0x508b13,-_0x42d586._0x1191ac))/(-0x16af+-0x1de*0x4+0x1e2e)+-parseInt(_0x36d3c1(_0x42d586._0x2e053b,_0x42d586._0x59edb9,0x87,_0x42d586._0x239cf6))/(0x1c27*0x1+-0x2283+0x1*0x664)+parseInt(_0x36d3c1(_0x42d586._0x1f0186,_0x42d586._0x920932,_0x42d586._0x1c6988,_0x42d586._0x33cae0))/(0x375*-0xb+0xd75+0x189b);if(_0x3404e1===_0x4c906b)break;else _0x1520b4['push'](_0x1520b4['shift']());}catch(_0x4054e5){_0x1520b4['push'](_0x1520b4['shift']());}}}(_0x2d74,0x330ea+0x1*-0x36d36+0x9f85a*0x1));const _0x37acaf=(function(){const _0x103c88={_0x16b360:0x142,_0x524163:0x156,_0x1c55ed:0x149,_0x3b35db:0x145,_0x112b83:0x153,_0x52557a:0x16f,_0x2264c9:0x15f,_0x1ed028:0x168,_0x5b6d9a:0x57f,_0x30a802:0x576,_0x1f0099:0x56a,_0x26235f:0x15c,_0x1adecb:0x158,_0x23f557:0x15e,_0x1c6a3c:0x158,_0x541229:0x159,_0x489be7:0x162,_0x4f021b:0x160,_0x1d23cd:0x151,_0x1cad6f:0x150,_0x2b5a52:0x154,_0x2cbcdf:0x14f,_0xeaa36e:0x141},_0x292dc0={_0xa83004:0x1c1,_0x2c3140:0x1b3,_0x817e88:0x1a8,_0x3e2033:0x220,_0x23e083:0x22a,_0x41ea92:0x22a,_0x2e880b:0x1cd,_0x3d04f4:0x1ca,_0x2f7b66:0x20f,_0x4e95d1:0x201,_0x2639fd:0x20c,_0xc47982:0x216,_0x636a6d:0x1bd,_0x498c10:0x1c8},_0x45fe03={_0x21c8da:0x2a9,_0x223ec0:0x2a0,_0x3df8fa:0x2a5,_0x55f56a:0x29c,_0x25d71e:0x2a8,_0x4e9602:0x2ab,_0x24739a:0x2a3,_0x41e5c5:0x43c,_0x2ac337:0x443,_0x3438bd:0x44a,_0x1b429c:0x438,_0x2c6d6c:0x43a,_0x57fbdc:0x42b,_0x6380cd:0x437},_0x46919d={_0x3111d9:0x1f4,_0x2c5c93:0x315,_0x1b361c:0x10b},_0x290bf4={_0x26298f:0xc4},_0x2e17fe={_0x453b6d:0x31b},_0x4d35de={_0x1cd880:0x3b7},_0x1fe756={};_0x1fe756[_0x1c8769(-_0x103c88._0x16b360,-_0x103c88._0x524163,-_0x103c88._0x1c55ed,-_0x103c88._0x3b35db)]=function(_0x4990a8,_0x3daa70){return _0x4990a8===_0x3daa70;},_0x1fe756[_0x1c8769(-_0x103c88._0x112b83,-_0x103c88._0x52557a,-_0x103c88._0x2264c9,-_0x103c88._0x1ed028)]=_0x31d90f(0x570,_0x103c88._0x5b6d9a,_0x103c88._0x30a802,_0x103c88._0x1f0099),_0x1fe756['StWVU']=_0x1c8769(-_0x103c88._0x26235f,-_0x103c88._0x1adecb,-_0x103c88._0x23f557,-0x165),_0x1fe756['yAnVW']=_0x1c8769(-_0x103c88._0x1c6a3c,-_0x103c88._0x541229,-_0x103c88._0x489be7,-_0x103c88._0x4f021b),_0x1fe756[_0x1c8769(-_0x103c88._0x1d23cd,-0x13d,-0x14d,-_0x103c88._0x1cad6f)]=_0x1c8769(-0x14e,-_0x103c88._0x2b5a52,-_0x103c88._0x2cbcdf,-_0x103c88._0xeaa36e);const _0x156cbc=_0x1fe756;function _0x31d90f(_0x1625cf,_0xa97904,_0x443459,_0x199191){return _0x11f8(_0x443459-_0x4d35de._0x1cd880,_0xa97904);}function _0x1c8769(_0xb7a855,_0x2bcaa0,_0x221961,_0x211124){return _0x11f8(_0x221961- -_0x2e17fe._0x453b6d,_0xb7a855);}let _0x57569c=!![];return function(_0xdb6a30,_0x3ede8f){const _0x5c3448={_0x1563e3:0x1a9,_0x31e9a3:0x1af},_0x1e3956={_0x596c2e:0xe8,_0x371dab:0xe6},_0x1c8430={_0xd8223:0x2b8},_0x597fcb={'BoVaQ':function(_0x4e343c,_0x40da83){function _0x95a1bb(_0x3d2778,_0x5ba34e,_0x49b84a,_0x4d8b61){return _0x11f8(_0x49b84a- -_0x1c8430._0xd8223,_0x4d8b61);}return _0x156cbc[_0x95a1bb(-0xee,-_0x1e3956._0x596c2e,-_0x1e3956._0x371dab,-0xec)](_0x4e343c,_0x40da83);},'ujmoQ':_0x156cbc[_0x597c9f(_0x292dc0._0xa83004,_0x292dc0._0x2c3140,_0x292dc0._0x817e88,0x1b6)],'BWtOp':_0x156cbc[_0x3c94a3(-_0x292dc0._0x3e2033,-_0x292dc0._0x23e083,-0x221,-_0x292dc0._0x41ea92)]};function _0x3c94a3(_0x49725c,_0x57b349,_0x2b797e,_0x20bda8){return _0x1c8769(_0x57b349,_0x57b349-0x1c7,_0x2b797e- -_0x290bf4._0x26298f,_0x20bda8-0x56);}function _0x597c9f(_0x36343a,_0x4a6d75,_0x9735a1,_0x8be91d){return _0x1c8769(_0x36343a,_0x4a6d75-_0x46919d._0x3111d9,_0x8be91d-_0x46919d._0x2c5c93,_0x8be91d-_0x46919d._0x1b361c);}if(_0x156cbc[_0x597c9f(0x1cb,_0x292dc0._0x2e880b,_0x292dc0._0x3d04f4,0x1cc)](_0x156cbc[_0x3c94a3(-_0x292dc0._0x2f7b66,-_0x292dc0._0x4e95d1,-_0x292dc0._0x2639fd,-_0x292dc0._0xc47982)],_0x156cbc[_0x597c9f(_0x292dc0._0x636a6d,0x1b9,0x1cf,_0x292dc0._0x498c10)])){const _0x3c59f5=_0x57c826?function(){const _0x4f247b={_0x5cfd0d:0x56,_0x2e4535:0xdf,_0x2c6824:0x365};function _0x432995(_0x2be4a6,_0x16ac8a,_0x3d4ba1,_0x3c22ee){return _0x597c9f(_0x3c22ee,_0x16ac8a-_0x4f247b._0x5cfd0d,_0x3d4ba1-_0x4f247b._0x2e4535,_0x3d4ba1- -_0x4f247b._0x2c6824);}if(_0xdeb0a4){const _0x412261=_0x4ac12e[_0x432995(-_0x5c3448._0x1563e3,-_0x5c3448._0x31e9a3,-0x1b4,-0x1b3)](_0x9daa28,arguments);return _0x176897=null,_0x412261;}}:function(){};return _0x148fa3=![],_0x3c59f5;}else{const _0x4ef43c=_0x57569c?function(){const _0x1727c8={_0x1b8085:0xe5,_0x1310c2:0x2,_0x17f0c8:0x27a},_0x30cb91={_0x42564a:0x50,_0x4cc986:0xc3,_0x51a790:0xe6};function _0x23c49d(_0x556d39,_0x5c1409,_0x2c3577,_0x25f854){return _0x597c9f(_0x556d39,_0x5c1409-_0x30cb91._0x42564a,_0x2c3577-_0x30cb91._0x4cc986,_0x5c1409-_0x30cb91._0x51a790);}function _0x45caff(_0x1b03b4,_0x55e703,_0x4402e7,_0x338929){return _0x597c9f(_0x338929,_0x55e703-_0x1727c8._0x1b8085,_0x4402e7-_0x1727c8._0x1310c2,_0x4402e7-_0x1727c8._0x17f0c8);}if(_0x3ede8f){if(_0x597fcb[_0x23c49d(_0x45fe03._0x21c8da,_0x45fe03._0x223ec0,_0x45fe03._0x3df8fa,_0x45fe03._0x55f56a)](_0x597fcb[_0x23c49d(_0x45fe03._0x25d71e,_0x45fe03._0x4e9602,_0x45fe03._0x3df8fa,_0x45fe03._0x24739a)],_0x597fcb[_0x45caff(_0x45fe03._0x41e5c5,0x43a,_0x45fe03._0x2ac337,_0x45fe03._0x3438bd)]))return new _0x396393((resolve,reject)=>{this.axios.post('updateOrdersAndListings',{login:_0x4521f3.data.username,session_key:_0x16de5c.xbot.xbot_session,listings:_0x1c5bc9.listings,listings_on_hold:_0x5e1018.listings_on_hold,listings_to_confirm:_0x1f82b6.listings_to_confirm,buy_orders:_0x57e3dd.buy_orders}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});else{const _0xe49213=_0x3ede8f[_0x45caff(_0x45fe03._0x1b429c,_0x45fe03._0x2c6d6c,_0x45fe03._0x57fbdc,_0x45fe03._0x6380cd)](_0xdb6a30,arguments);return _0x3ede8f=null,_0xe49213;}}}:function(){};return _0x57569c=![],_0x4ef43c;}};}()),_0x17f3d2=_0x37acaf(this,function(){const _0x3ee93e={_0x34f104:0x1c,_0x3f37f6:0xa,_0x258c70:0xe,_0x77af43:0x15,_0x1d0f98:0x3f,_0x216b3d:0x22,_0x7743b0:0x2d,_0x1e9f86:0x1f,_0x30fdec:0x1d,_0x536737:0x1f,_0x19d286:0x57e,_0x4b7f5e:0x58b,_0x138139:0x59b,_0x5f4363:0x586,_0x19f91a:0x23,_0x17b89e:0x21,_0x56df62:0x58d,_0x46f473:0x58b,_0x1314bb:0x57b,_0x57c800:0x57c},_0x56d54e={_0x596048:0x3bb},_0x3fd08c={_0x38eb7e:0x1e5},_0x1dd926={};function _0x558b5c(_0x356efa,_0x4232b9,_0x5f58fb,_0x430a32){return _0x11f8(_0x430a32- -_0x3fd08c._0x38eb7e,_0x4232b9);}_0x1dd926[_0x558b5c(-_0x3ee93e._0x34f104,-_0x3ee93e._0x3f37f6,-_0x3ee93e._0x258c70,-_0x3ee93e._0x77af43)]=_0x558b5c(-_0x3ee93e._0x1d0f98,-0x32,-_0x3ee93e._0x216b3d,-0x30)+'+$';const _0x50315d=_0x1dd926;function _0x1c31b0(_0xa8dee1,_0x3f67b7,_0x5e0e5a,_0xc47cc9){return _0x11f8(_0x3f67b7-_0x56d54e._0x596048,_0x5e0e5a);}return _0x17f3d2['toString']()[_0x558b5c(-_0x3ee93e._0x7743b0,-_0x3ee93e._0x1e9f86,-_0x3ee93e._0x30fdec,-_0x3ee93e._0x536737)](_0x50315d[_0x1c31b0(_0x3ee93e._0x19d286,_0x3ee93e._0x4b7f5e,_0x3ee93e._0x138139,_0x3ee93e._0x5f4363)])[_0x558b5c(-_0x3ee93e._0x1e9f86,-_0x3ee93e._0x19f91a,-_0x3ee93e._0x17b89e,-0x1e)]()['constructo'+'r'](_0x17f3d2)['search'](_0x50315d[_0x1c31b0(_0x3ee93e._0x56df62,_0x3ee93e._0x46f473,_0x3ee93e._0x1314bb,_0x3ee93e._0x57c800)]);});_0x17f3d2();const axios=require(_0x2fd468(0x568,0x578,0x56a,0x55d)),https=require(_0xd64eb3(0x407,0x417,0x410,0x40f)),SteamTotp=require(_0xd64eb3(0x41e,0x41d,0x420,0x416)),xbsteam=require(_0x2fd468(0x54a,0x551,0x556,0x563)),_0x7f9a6e={};function _0x11f8(_0x1557b8,_0x379def){const _0x288cd2=_0x2d74();return _0x11f8=function(_0x4b10d2,_0x45c59a){_0x4b10d2=_0x4b10d2-(-0xb*-0x1f7+-0x1*-0xe93+-0x227c);let _0xce1388=_0x288cd2[_0x4b10d2];if(_0x11f8['EBiZXO']===undefined){var _0xdf28b8=function(_0x151e5d){const _0x408cfd='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x50048d='',_0x1af7bb='',_0x34123b=_0x50048d+_0xdf28b8;for(let _0x2b5395=0x16b+-0x663+0x4f8,_0x330478,_0x3524da,_0x43e493=0x17b7+0x5*-0x2b9+-0x6*0x1af;_0x3524da=_0x151e5d['charAt'](_0x43e493++);~_0x3524da&&(_0x330478=_0x2b5395%(0x20d9+-0x1c*0x80+-0x12d5)?_0x330478*(-0x1*0x1bab+-0x6af*0x5+0x3d56)+_0x3524da:_0x3524da,_0x2b5395++%(0x3*0x5ea+0x1540+-0x137d*0x2))?_0x50048d+=_0x34123b['charCodeAt'](_0x43e493+(0x3*0x445+0xd42+-0x1a07))-(0x1*0x1877+-0x4c1*0x7+0x8da)!==0x1b36+-0x91*-0x2e+0x2*-0x1aa2?String['fromCharCode'](-0x1d35+0x2*-0x11ce+-0x90*-0x75&_0x330478>>(-(-0x5*-0x5d0+-0x16f7*0x1+-0x617)*_0x2b5395&-0xae1*0x1+0x16*-0x4c+-0x1*-0x116f)):_0x2b5395:-0x1831+0x1*0x1afa+-0x1f*0x17){_0x3524da=_0x408cfd['indexOf'](_0x3524da);}for(let _0x103e3a=0x2428+0x1478+-0x38a0*0x1,_0x331e29=_0x50048d['length'];_0x103e3a<_0x331e29;_0x103e3a++){_0x1af7bb+='%'+('00'+_0x50048d['charCodeAt'](_0x103e3a)['toString'](-0x1597+0x1*-0x1475+-0x1ea*-0x16))['slice'](-(-0x37c*-0x9+-0x150c+-0x527*0x2));}return decodeURIComponent(_0x1af7bb);};_0x11f8['ysFpsh']=_0xdf28b8,_0x1557b8=arguments,_0x11f8['EBiZXO']=!![];}const _0x7d4c12=_0x288cd2[0x2090+-0x1ca+-0x1ec6],_0x46ce89=_0x4b10d2+_0x7d4c12,_0x443525=_0x1557b8[_0x46ce89];if(!_0x443525){const _0x4440cc=function(_0x3a3689){this['JUNpTz']=_0x3a3689,this['jJSRBQ']=[-0x19a7*0x1+-0x7*0xb+-0x19f5*-0x1,-0xf8c+0x1*0x65b+0x931,0x229c+-0x81a+0xd*-0x20a],this['otkBIM']=function(){return'newState';},this['dnbrfd']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['bkFgpK']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4440cc['prototype']['scEmch']=function(){const _0x1d6cba=new RegExp(this['dnbrfd']+this['bkFgpK']),_0x24f802=_0x1d6cba['test'](this['otkBIM']['toString']())?--this['jJSRBQ'][-0x574+0x1*0x89+-0x24*-0x23]:--this['jJSRBQ'][0x12d6*0x2+-0xfbd+-0x15ef];return this['zNUMtP'](_0x24f802);},_0x4440cc['prototype']['zNUMtP']=function(_0x28bc46){if(!Boolean(~_0x28bc46))return _0x28bc46;return this['yPpNCd'](this['JUNpTz']);},_0x4440cc['prototype']['yPpNCd']=function(_0x5d3f66){for(let _0x677cc5=0x207f+-0x75*-0x33+-0x37ce,_0x149471=this['jJSRBQ']['length'];_0x677cc5<_0x149471;_0x677cc5++){this['jJSRBQ']['push'](Math['round'](Math['random']())),_0x149471=this['jJSRBQ']['length'];}return _0x5d3f66(this['jJSRBQ'][0x89*0x47+-0x2575+0x6*-0x17]);},new _0x4440cc(_0x11f8)['scEmch'](),_0xce1388=_0x11f8['ysFpsh'](_0xce1388),_0x1557b8[_0x46ce89]=_0xce1388;}else _0xce1388=_0x443525;return _0xce1388;},_0x11f8(_0x1557b8,_0x379def);}function _0x2d74(){const _0x109da0=['u3rxvLu','u0n3wfy','qM9wyve','mJKZmdq0nu1WqvzQzG','C3rLyw0TDg90Ca','mtaYmdeWounvtLPwtG','mLvnwNn3Dq','m2zywvjJwa','C2vHCMnO','Dg9tDhjPBMC','yxHPB3m','mtqXmJmXmeXewgfZEG','mti5mZyWnenmvffAuq','DwPTB1e','twnVv3a','nJKYmJK1mKD4ENLXDa','C09XDMi','qLD0t3a','v3P1Dwm','mtq4odeZmJLOv2L0z3K','r1rZzwu','EufUvLC','lI9ZDgvHBq','kcGOlISPkYKRkq','DgHVCML6zwq','yxbWBhK','mtGXnJu2mhryyxjvuG','BxbPzfu','zxHWB3j0CW','Ahr0Chm','D3vcANK','uNr1wMO'];_0x2d74=function(){return _0x109da0;};return _0x2d74();}function _0xd64eb3(_0x52ea42,_0x1c57f5,_0xa22262,_0x56eafa){const _0xa8aeba={_0xe87763:0x254};return _0x11f8(_0x56eafa-_0xa8aeba._0xe87763,_0x52ea42);}_0x7f9a6e['rejectUnau'+_0x2fd468(0x554,0x557,0x558,0x551)]=![];function _0x2fd468(_0x2245ef,_0x638223,_0x2a0225,_0x18e1a8){const _0x5cc0f2={_0xf74997:0x3a2};return _0x11f8(_0x2a0225-_0x5cc0f2._0xf74997,_0x2245ef);}const httpsAgent=new https['Agent'](_0x7f9a6e);module[_0xd64eb3(0x3ff,0x405,0x40c,0x40e)]=class xbot{xbot_apiurl=global.xbot_apiurl;prefix='[xbot.gg] ';axiosconfig={httpsAgent:httpsAgent,withCredentials:true,baseURL:this.xbot_apiurl,timeout:10000,headers:{'Authorization':`Bearer ${global.data.apiKey}`,'Accept':'application/json','X-Requested-With':'XMLHttpRequest','X-Bot-Version':global.data.version}};axios=null;xbot_session=null;axios=axios.create(this.axiosconfig);auth(){return new Promise((resolve,reject)=>{this.axios.post('auth',{login:global.data.username}).then(function(response){global.xbot.xbot_session=response.data.session_key;if(response.data.status==0){global.xbot.xbot_loggedIn=true;}resolve(response.data.session_key);console.log(global.xbot.prefix+'Успешно авторизован');}).catch(function(error){reject(error);});});}xbot_loggedIn=false;lastsentauthkey='';async ping(authkey){return await new Promise(async(resolve,reject)=>{this.lastsentauthkey=authkey;this.axios.post('ping',{login:global.data.username,session_key:global.xbot.xbot_session,authkey:authkey}).then(function(response){resolve(response);}).catch(async function(error){global.xbot.xbot_loggedIn=false;console.error('Error:',error);reject(error);});});}invcontexts=[];updateOrdersAndListings(data){return new Promise((resolve,reject)=>{this.axios.post('updateOrdersAndListings',{login:global.data.username,session_key:global.xbot.xbot_session,listings:data.listings,listings_on_hold:data.listings_on_hold,listings_to_confirm:data.listings_to_confirm,buy_orders:data.buy_orders}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}updateAccountData(user,contexts,wallet){return new Promise((resolve,reject)=>{user._community=null;user.session_key=null;if(contexts!==undefined){this.invcontexts=Object.keys(contexts);}this.axios.post('updateAccountData',{login:global.data.username,session_key:this.xbot_session,account:user,inventoryContexts:contexts,wallet:wallet}).then(function(response){resolve(response);}).catch(function(error){reject(error);console.error('Error:',error.response.data);});});}updateInventory(appid,inventory){return new Promise((resolve,reject)=>{this.axios.post('updateInventory',{login:global.data.username,session_key:this.xbot_session,inventory:inventory,appid:appid}).catch(function(error){reject(error);console.error('Error:',error.response.data);}).then(function(data){resolve(data);});});}userdata=null;getJobs(){return new Promise((resolve,reject)=>{this.axios.post('getJobs',{login:global.data.username,session_key:this.xbot_session}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}sellHook(jobId,data){return new Promise((resolve,reject)=>{this.axios.post('sellItemHook/'+jobId,{login:global.data.username,session_key:this.xbot_session,data:data}).then(function(response){console.log(response.data);resolve(response.data);}).catch(function(error){reject(error);});});}sendJobResult(job,status,result){try{console.log('['+status+'] sending job result '+job.id);this.axios.post('jobResult/'+job.id,{login:global.data.username,session_key:this.xbot_session,jobId:job.id,status:status,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log('Произошла ошибка при отправке статуса задания '+job.id);}}customLog(code,message){try{this.axios.post('customLog',{login:global.data.username,session_key:this.xbot_session,code:code,message:message}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log(ex);console.log('Произошла ошибка при отправке лога ');}}history(result){this.axios.post('updateLatestHistory',{login:global.data.username,session_key:this.xbot_session,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}async processJob(job){return await new Promise(async(resolve,reject)=>{try{switch(job.type){case 1:await global.xbsteam.getItemEconomics(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).catch(function(ex){console.log(ex);}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 2:const j=await new Promise(async(resolve2,reject2)=>{resolve2(await global.sc.getUserInventory(global.xbot.userdata.steamID,job.context.appid,job.context.contextid,false,function(e,inv,currency){if(e){reject2(e);return;}resolve2(inv);}));}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 3:await global.xbsteam.getItemPriceHistory(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',{priceHistory:r});}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 4:await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 5:await global.xbsteam.getItemMarketNameId(job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 6:await global.xbsteam.checkAbilityToTrade(job.context.partner,job.context.token).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'true',{error:e.message});});break;case 7:await global.xbsteam.sendTradeOffer(job.context.steam_id,job.context.items,job.context.partner,job.context.token).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 8:await global.xbsteam.setConfirmationStatus(job.context.confirmation_id,job.context.key,job.context.accept).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 9:await global.xbsteam.cancelTradeOffer(job.context.trade_offer_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 10:await global.xbsteam.acceptTradeOffer(job.context.trade_offer_id,job.context.partner).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 11:await global.xbsteam.updateTradeOffers().then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 12:if(job.context.analyze===true){const data=await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id);var hook=this.sellHook(job.id,data);if(hook.price!==undefined&&hook.price>0){job.context.price=hook.price;}}await global.xbsteam.sellItem(job.context.appid,job.context.contextid,job.context.assetid,job.context.amount,job.context.price).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 13:await global.xbsteam.cancelSellListing(job.context.listingId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 14:await global.xbsteam.createBuyOrder(job.context.currency,job.context.appid,job.context.market_hash_name,job.context.price_total,job.context.quantity,job.context.billing_state,job.context.save_my_address).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 15:await global.xbsteam.cancelBuyOrder(job.context.orderId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 16:await global.xbsteam.getMarketHistory(job.context.offset,job.context.limit).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;default:console.log('unknown job type');console.log(job.type);new Error('Unknown job type');break;}}catch(ex){this.sendJobResult(job,false,null);console.log(ex);global.sc.wait();console.log('Произошла ошибка при обработке задания #'+job.id);}resolve();});}async sendConfirmations(){const self=this;global.sc.wait();await global.xbsteam.getConfirmations().then(function(data){self.axios.post('updateConfirmations',{login:global.data.username,session_key:global.xbot.xbot_session,confirmations:data}).then(function(response){console.log('Отправлено '+data.length+' Confirmations');}).catch(function(error){console.log(error.message);});}).catch(function(e){console.log('Произошла ошибка при проверке аунтентификатора');});}async processInventory(){return await new Promise(async(resolve,reject)=>{console.log(this.prefix+'Обновляю инвентарь');await global.sc.wait();const arr=await global.xbsteam.getInventoryContexts(global.sc.steamID);const data=arr[0];const wallet=arr[1];global.xbot.updateAccountData(global.xbot.userdata,data,wallet);const invcontexts=Object.keys(data);for(const invc of invcontexts){await new Promise(async(resolve2,reject2)=>{await global.sc.wait();global.sc.getUserInventory(global.xbot.userdata.steamID,invc,2,false,function(e,inv,currency){if(e){reject2(e);return;}global.xbot.updateInventory(invc,inv);resolve2(data);});}).catch(function(e){console.log(e);}).then(function(data){console.log(global.xbot.prefix+invc+' updated');});}resolve();});}loop(tickCounter){return new Promise(async(resolve,reject)=>{try{if(!this.xbot_loggedIn){console.log(this.prefix+'Попытка авторизации');await this.auth().catch(await function(e){return new Promise(async resolve2=>{console.log(e.response?.data);console.log('Ошибка авторизации. Проверьте API ключ');await new Promise(resolve2=>setTimeout(resolve,global.data.tickDelay*2));resolve2();});});if(this.xbot_loggedIn){console.log(this.prefix+'Обновляю данные пользователя');await global.sc.wait();await global.sc.getSteamUser(sc.steamID,(err,user)=>{if(err){console.error('steam: Ошибка при получении информации о пользователе:');this.xbot_loggedIn=false;}else{user.steamID64=user.steamID.getSteamID64();global.xbot.userdata=user;}});}}if(this.xbot_loggedIn&&global.xbot.userdata!==null){if(tickCounter%global.data.ticks.checkConfirmations===0||global.data.needToSendConfirmations===true){console.log(this.prefix+'Проверяю аутентификатор');await this.sendConfirmations();global.data.needToSendConfirmations=false;await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}let authkey=SteamTotp.getAuthCode(global.data.sharedSecret);if(tickCounter%global.data.ticks.ping===0||this.lastsentauthkey!==authkey){await this.ping(authkey);}if(tickCounter%global.data.ticks.sendInventory===0||tickCounter===2){await this.processInventory();}if(tickCounter%global.data.ticks.sendOrders===0||tickCounter===2){console.log(this.prefix+'Проверяю ордера');await global.sc.wait();await global.xbsteam.getOrders().then(function(data){global.xbot.updateOrdersAndListings(data);});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}if(tickCounter%global.data.ticks.lastHistory===0||tickCounter===2){console.log(this.prefix+'Обновляю историю операций');var a=await global.xbsteam.getMarketHistory(0,100);this.history(a);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}const jobsResponse=await this.getJobs();const jobs=jobsResponse.jobs;console.log(this.prefix+'Получено '+jobs.length+' заданий');for(const job of jobs){await this.processJob(job);}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));resolve();}catch(ex){console.log(ex);reject(ex);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*25));}});}};