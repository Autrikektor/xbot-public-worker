(function(_0xe3a362,_0x1f16ef){const _0x4bc282={_0xa78aff:0x4cb,_0x29c260:0x4d0,_0x5c0560:0x25e,_0x41ca40:0x251,_0x48a1fa:0x24f,_0x4b4f31:0x4c8,_0x4372f0:0x4c9,_0x432e85:0x252,_0x1ec58a:0x240,_0x2af643:0x4ce,_0x1400da:0x4e2,_0x28341e:0x4dc,_0x1e0b67:0x4c8,_0x16fbfe:0x4d8,_0x43c20f:0x4ce,_0x5d66a3:0x4c6,_0x5a5843:0x4c8,_0x12311a:0x4d6,_0x278d4b:0x4d5,_0x8ce9ea:0x4d1,_0x17dfb5:0x255,_0x3b8aad:0x25e,_0x4079a6:0x4d1,_0x38cb13:0x4d9,_0x4f5213:0x259,_0x4524a0:0x248,_0x5d1f1e:0x24f,_0x1bb7b6:0x24e},_0x4ee56e={_0x2c5b7b:0x352};function _0x33f31e(_0x4d632f,_0x54c4b1,_0x4775b9,_0x11146d){return _0x5080(_0x4775b9-0xd5,_0x54c4b1);}function _0x1d4087(_0x3bcd87,_0x409539,_0x1a920e,_0x37015e){return _0x5080(_0x409539-_0x4ee56e._0x2c5b7b,_0x1a920e);}const _0x1867f9=_0xe3a362();while(!![]){try{const _0x38d40e=-parseInt(_0x1d4087(0x4d2,0x4c9,_0x4bc282._0xa78aff,_0x4bc282._0x29c260))/(-0x481+0x14c5+-0x17*0xb5)*(parseInt(_0x33f31e(_0x4bc282._0x5c0560,_0x4bc282._0x41ca40,0x257,_0x4bc282._0x48a1fa))/(0x3*0xacc+-0x1f7+-0x1e6b))+-parseInt(_0x1d4087(0x4cb,_0x4bc282._0x4b4f31,0x4cd,_0x4bc282._0x4372f0))/(-0x242c+-0x1d20+0x414f*0x1)*(parseInt(_0x33f31e(0x248,_0x4bc282._0x432e85,0x24a,_0x4bc282._0x1ec58a))/(0x1cb6+-0x2*0xbaf+-0x4*0x155))+-parseInt(_0x1d4087(_0x4bc282._0x2af643,0x4d8,_0x4bc282._0x1400da,_0x4bc282._0x28341e))/(0x1c6b+0x149*-0x1+0xb*-0x277)*(parseInt(_0x1d4087(0x4c8,0x4d0,_0x4bc282._0x1e0b67,0x4d1))/(-0x1d33+-0xb5*-0x3+-0x2*-0xd8d))+-parseInt(_0x1d4087(_0x4bc282._0x16fbfe,_0x4bc282._0x43c20f,_0x4bc282._0x5d66a3,_0x4bc282._0x5a5843))/(-0x5*0x4a9+-0x2468+0x3bbc)+parseInt(_0x1d4087(0x4d7,_0x4bc282._0x12311a,_0x4bc282._0x278d4b,_0x4bc282._0x8ce9ea))/(-0xb37*0x1+0x2a*-0xdf+0x2fd5)*(-parseInt(_0x33f31e(_0x4bc282._0x17dfb5,0x259,0x258,_0x4bc282._0x3b8aad))/(-0x29*0x69+-0x3d4*0x8+-0x2f7a*-0x1))+parseInt(_0x1d4087(_0x4bc282._0x5d66a3,_0x4bc282._0x4079a6,_0x4bc282._0x38cb13,0x4d2))/(-0x1*0x1b72+-0xa*-0x7b+-0x16ae*-0x1)+parseInt(_0x33f31e(_0x4bc282._0x4f5213,_0x4bc282._0x4524a0,_0x4bc282._0x5d1f1e,_0x4bc282._0x1bb7b6))/(0x254*0x2+0x1bb*0x7+0x85d*-0x2);if(_0x38d40e===_0x1f16ef)break;else _0x1867f9['push'](_0x1867f9['shift']());}catch(_0x1f5c2b){_0x1867f9['push'](_0x1867f9['shift']());}}}(_0x3171,0x1*0xc4336+-0xe0b5b+0x332f*0x2f));const _0x1d693e=(function(){let _0x5d633c=!![];return function(_0x52bf80,_0x5a6f40){const _0x144c14={_0x2c5672:0xbe,_0x18eed1:0xbb},_0xa4967b={_0x5a4c13:0xc2},_0x3f88ab=_0x5d633c?function(){function _0x5ce865(_0x264869,_0x4ebcbf,_0x41cf40,_0x5cfc57){return _0x5080(_0x4ebcbf- -_0xa4967b._0x5a4c13,_0x264869);}if(_0x5a6f40){const _0x13308c=_0x5a6f40[_0x5ce865(0xb7,_0x144c14._0x2c5672,_0x144c14._0x2c5672,_0x144c14._0x18eed1)](_0x52bf80,arguments);return _0x5a6f40=null,_0x13308c;}}:function(){};return _0x5d633c=![],_0x3f88ab;};}()),_0x3b827c=_0x1d693e(this,function(){const _0x3a4f0a={_0x1d78f1:0x193,_0x54688f:0x19f,_0x44973a:0x197,_0x31a9f5:0x195,_0x4f37f8:0x1a2,_0x19dc9c:0x190,_0x214616:0x197,_0x49068e:0x18d,_0x3eaa95:0x190,_0x2afa0c:0x18d,_0x5257b8:0x188,_0x41369d:0x195,_0x2f1916:0x191,_0x38c26c:0x19b},_0x268a7d={_0x4625b1:0x318},_0x3df2a2={_0x817525:0x22f};function _0x3465c4(_0x5101a1,_0x3f1dac,_0x5e686d,_0x5340d0){return _0x5080(_0x5340d0- -_0x3df2a2._0x817525,_0x5101a1);}const _0x1557b7={};_0x1557b7[_0x3fb77d(-_0x3a4f0a._0x1d78f1,-0x193,-0x191,-0x18e)]=_0x3fb77d(-_0x3a4f0a._0x54688f,-_0x3a4f0a._0x44973a,-_0x3a4f0a._0x31a9f5,-_0x3a4f0a._0x4f37f8)+'+$';const _0x46da48=_0x1557b7;function _0x3fb77d(_0x34eddd,_0xa01bc4,_0x3e2306,_0x4919eb){return _0x5080(_0xa01bc4- -_0x268a7d._0x4625b1,_0x4919eb);}return _0x3b827c['toString']()[_0x3fb77d(-0x187,-_0x3a4f0a._0x19dc9c,-_0x3a4f0a._0x214616,-0x189)](_0x46da48['wsaOa'])['toString']()['constructo'+'r'](_0x3b827c)[_0x3fb77d(-_0x3a4f0a._0x49068e,-_0x3a4f0a._0x3eaa95,-_0x3a4f0a._0x2afa0c,-_0x3a4f0a._0x5257b8)](_0x46da48[_0x3fb77d(-_0x3a4f0a._0x41369d,-0x193,-_0x3a4f0a._0x2f1916,-_0x3a4f0a._0x38c26c)]);});function _0x580eeb(_0x51780e,_0x3ab36a,_0x889a81,_0x4a4791){const _0x1b3b1c={_0x5b2fb0:0x90};return _0x5080(_0x3ab36a-_0x1b3b1c._0x5b2fb0,_0x889a81);}_0x3b827c();function _0x5080(_0x19ae5d,_0x257a02){const _0x5a3b59=_0x3171();return _0x5080=function(_0x24efac,_0x4af399){_0x24efac=_0x24efac-(0x88+-0xc*-0xd5+0x91*-0x10);let _0x54283f=_0x5a3b59[_0x24efac];if(_0x5080['MaEpuJ']===undefined){var _0x5a7108=function(_0xa83b46){const _0xd1c07b='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4870fe='',_0x5d40ed='',_0x3a72cf=_0x4870fe+_0x5a7108;for(let _0x5578a2=-0x15*-0x191+0x1bf+-0x22a4,_0x2dae3a,_0x133e90,_0x1dcad8=0xb*0x10f+0x142e+-0x1fd3;_0x133e90=_0xa83b46['charAt'](_0x1dcad8++);~_0x133e90&&(_0x2dae3a=_0x5578a2%(-0x1735+-0x1*-0x110b+0x2*0x317)?_0x2dae3a*(-0x1a52+-0x1c3d+0x36cf)+_0x133e90:_0x133e90,_0x5578a2++%(0x1d*-0x29+0x32*0x2c+-0x3ef))?_0x4870fe+=_0x3a72cf['charCodeAt'](_0x1dcad8+(-0x1*-0x871+-0x134e*-0x2+0x1d*-0x19f))-(0x247d*-0x1+-0x1ad5+0xa*0x656)!==0x93+0x23d6+-0x2469?String['fromCharCode'](-0x68a+-0xce2+0x146b*0x1&_0x2dae3a>>(-(-0x1*0xd5a+-0x3b*-0x11+-0x1*-0x971)*_0x5578a2&-0x1a18+0x111+0x190d)):_0x5578a2:-0x1b1*-0x4+0x7*0x502+-0x2*0x14e9){_0x133e90=_0xd1c07b['indexOf'](_0x133e90);}for(let _0x59fa22=0x2088+0x537+-0xc95*0x3,_0x103945=_0x4870fe['length'];_0x59fa22<_0x103945;_0x59fa22++){_0x5d40ed+='%'+('00'+_0x4870fe['charCodeAt'](_0x59fa22)['toString'](0xdb*-0x16+-0x1926+0x581*0x8))['slice'](-(-0x3ae+0x1*0x23b3+-0x667*0x5));}return decodeURIComponent(_0x5d40ed);};_0x5080['teGvqv']=_0x5a7108,_0x19ae5d=arguments,_0x5080['MaEpuJ']=!![];}const _0x2f8b31=_0x5a3b59[-0x1f76+-0x2640+0x45b6],_0x25abc4=_0x24efac+_0x2f8b31,_0x1c9915=_0x19ae5d[_0x25abc4];if(!_0x1c9915){const _0x18e938=function(_0x3e2ce0){this['MtoCGS']=_0x3e2ce0,this['AZCXww']=[0x1366*0x2+0xc4a+0x3315*-0x1,-0x154e+0x1*0x1ae+0x13a0,0x20b2+0xc19*-0x1+-0x1499],this['KdybWn']=function(){return'newState';},this['mavNIt']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['xRUobC']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x18e938['prototype']['oQppcC']=function(){const _0x4716ae=new RegExp(this['mavNIt']+this['xRUobC']),_0x1f98e8=_0x4716ae['test'](this['KdybWn']['toString']())?--this['AZCXww'][-0x1c11+-0x13e3+0x2ff5*0x1]:--this['AZCXww'][0x1*0x1eef+0xb9f+-0x2a8e*0x1];return this['XUuCUj'](_0x1f98e8);},_0x18e938['prototype']['XUuCUj']=function(_0x5cde90){if(!Boolean(~_0x5cde90))return _0x5cde90;return this['CUAPhL'](this['MtoCGS']);},_0x18e938['prototype']['CUAPhL']=function(_0x17b357){for(let _0x55fa15=0x15*0x15+0xb*-0x116+0xa39,_0x536ea5=this['AZCXww']['length'];_0x55fa15<_0x536ea5;_0x55fa15++){this['AZCXww']['push'](Math['round'](Math['random']())),_0x536ea5=this['AZCXww']['length'];}return _0x17b357(this['AZCXww'][0xc*-0x327+-0x1015*-0x2+0x5aa]);},new _0x18e938(_0x5080)['oQppcC'](),_0x54283f=_0x5080['teGvqv'](_0x54283f),_0x19ae5d[_0x25abc4]=_0x54283f;}else _0x54283f=_0x1c9915;return _0x54283f;},_0x5080(_0x19ae5d,_0x257a02);}function _0x3171(){const _0x3cf52f=['mZq4nJa5mwjHtwfVtq','Ahr0Chm','mJG3mJe0vMjfEuT0','otK2mtGXmgLdEMLnEa','yxbWBhK','kcGOlISPkYKRkq','mMvmu2zsvW','odCXndDgwgDrvKK','ndq4s1bJBu1W','D3nHt2e','mJvtBgDLAMK','qwDLBNq','C2vHCMnO','lI9ZDgvHBq','nde4nePMtMrpwG','mtq2n0vKyu5luG','otyWnJC5zgDUq0Lj','CMvQzwn0vw5HDq','zxHWB3j0CW','mJq4mdeZmJzswuzywM8','yxHPB3m'];_0x3171=function(){return _0x3cf52f;};return _0x3171();}const axios=require(_0x580eeb(0x207,0x20b,0x209,0x215)),https=require(_0x271c7c(0x248,0x256,0x24f,0x24b)),SteamTotp=require('steam-totp'),xbsteam=require(_0x271c7c(0x248,0x243,0x246,0x244)),_0x18c508={};_0x18c508[_0x580eeb(0x20e,0x208,0x1ff,0x203)+'thorized']=![];const httpsAgent=new https[(_0x271c7c(0x255,0x257,0x259,0x262))](_0x18c508);function _0x271c7c(_0x43841f,_0x120046,_0x3268c7,_0x4cace6){const _0x50f730={_0x3abdd5:0xd2};return _0x5080(_0x3268c7-_0x50f730._0x3abdd5,_0x4cace6);}module[_0x580eeb(0x20a,0x209,0x209,0x20e)]=class xbot{xbot_apiurl=global.xbot_apiurl;prefix='[xbot.gg] ';axiosconfig={httpsAgent:httpsAgent,withCredentials:true,baseURL:this.xbot_apiurl,timeout:10000,headers:{'Authorization':`Bearer ${global.data.apiKey}`,'Accept':'application/json','X-Requested-With':'XMLHttpRequest','X-Bot-Version':global.data.version}};axios=null;xbot_session=null;axios=axios.create(this.axiosconfig);auth(){return new Promise((resolve,reject)=>{this.axios.post('auth',{login:global.data.username}).then(function(response){global.xbot.xbot_session=response.data.session_key;if(response.data.status==0){global.xbot.xbot_loggedIn=true;}resolve(response.data.session_key);console.log(global.xbot.prefix+'Успешно авторизован');}).catch(function(error){reject(error);});});}xbot_loggedIn=false;lastsentauthkey='';async ping(authkey){return await new Promise(async(resolve,reject)=>{this.lastsentauthkey=authkey;this.axios.post('ping',{login:global.data.username,session_key:global.xbot.xbot_session,authkey:authkey}).then(function(response){resolve(response);}).catch(async function(error){global.xbot.xbot_loggedIn=false;console.error('Error:',error);reject(error);});});}invcontexts=[];updateOrdersAndListings(data){return new Promise((resolve,reject)=>{this.axios.post('updateOrdersAndListings',{login:global.data.username,session_key:global.xbot.xbot_session,listings:data.listings,listings_on_hold:data.listings_on_hold,listings_to_confirm:data.listings_to_confirm,buy_orders:data.buy_orders}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}updateAccountData(user,contexts,wallet){return new Promise((resolve,reject)=>{user._community=null;user.session_key=null;if(contexts!==undefined){this.invcontexts=Object.keys(contexts);}this.axios.post('updateAccountData',{login:global.data.username,session_key:this.xbot_session,account:user,inventoryContexts:contexts,wallet:wallet}).then(function(response){resolve(response);}).catch(function(error){reject(error);console.error('Error:',error.response.data);});});}updateInventory(appid,inventory){return new Promise((resolve,reject)=>{this.axios.post('updateInventory',{login:global.data.username,session_key:this.xbot_session,inventory:inventory,appid:appid}).catch(function(error){reject(error);console.error('Error:',error.response.data);}).then(function(data){resolve(data);});});}userdata=null;getJobs(){return new Promise((resolve,reject)=>{this.axios.post('getJobs',{login:global.data.username,session_key:this.xbot_session}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}sellHook(jobId,data){return new Promise((resolve,reject)=>{this.axios.post('sellItemHook/'+jobId,{login:global.data.username,session_key:this.xbot_session,data:data}).then(function(response){console.log(response.data);resolve(response.data);}).catch(function(error){reject(error);});});}sendJobResult(job,status,result){try{console.log('['+status+'] sending job result '+job.id);this.axios.post('jobResult/'+job.id,{login:global.data.username,session_key:this.xbot_session,jobId:job.id,status:status,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log('Произошла ошибка при отправке статуса задания '+job.id);}}customLog(code,message){try{this.axios.post('customLog',{login:global.data.username,session_key:this.xbot_session,code:code,message:message}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log(ex);console.log('Произошла ошибка при отправке лога ');}}history(result){this.axios.post('updateLatestHistory',{login:global.data.username,session_key:this.xbot_session,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}async processJob(job){return await new Promise(async(resolve,reject)=>{try{switch(job.type){case 1:await global.xbsteam.getItemEconomics(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).catch(function(ex){console.log(ex);}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 2:const j=await new Promise(async(resolve2,reject2)=>{resolve2(await global.sc.getUserInventory(global.xbot.userdata.steamID,job.context.appid,job.context.contextid,false,function(e,inv,currency){if(e){reject2(e);return;}resolve2(inv);}));}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 3:await global.xbsteam.getItemPriceHistory(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',{priceHistory:r});}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 4:await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 5:await global.xbsteam.getItemMarketNameId(job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 6:await global.xbsteam.checkAbilityToTrade(job.context.partner,job.context.token).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'true',{error:e.message});});break;case 7:await global.xbsteam.sendTradeOffer(job.context.steam_id,job.context.items,job.context.partner,job.context.token).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 8:await global.xbsteam.setConfirmationStatus(job.context.confirmation_id,job.context.key,job.context.accept).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 9:await global.xbsteam.cancelTradeOffer(job.context.trade_offer_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 10:await global.xbsteam.acceptTradeOffer(job.context.trade_offer_id,job.context.partner).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 11:await global.xbsteam.updateTradeOffers().then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 12:if(job.context.analyze===true){const data=await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id);var hook=this.sellHook(job.id,data);if(hook.price!==undefined&&hook.price>0){job.context.price=hook.price;}}await global.xbsteam.sellItem(job.context.appid,job.context.contextid,job.context.assetid,job.context.amount,job.context.price).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 13:await global.xbsteam.cancelSellListing(job.context.listingId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 14:await global.xbsteam.createBuyOrder(job.context.currency,job.context.appid,job.context.market_hash_name,job.context.price_total,job.context.quantity,job.context.billing_state,job.context.save_my_address).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 15:await global.xbsteam.cancelBuyOrder(job.context.orderId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 16:await global.xbsteam.getMarketHistory(job.context.offset,job.context.limit).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;default:console.log('unknown job type');console.log(job.type);new Error('Unknown job type');break;}}catch(ex){this.sendJobResult(job,false,null);console.log(ex);global.sc.wait();console.log('Произошла ошибка при обработке задания #'+job.id);}resolve();});}async sendConfirmations(){const self=this;global.sc.wait();await global.xbsteam.getConfirmations().then(function(data){self.axios.post('updateConfirmations',{login:global.data.username,session_key:global.xbot.xbot_session,confirmations:data}).then(function(response){console.log('Отправлено '+data.length+' Confirmations');}).catch(function(error){console.log(error.message);});}).catch(function(e){console.log('Произошла ошибка при проверке аунтентификатора');});}async processInventory(){return await new Promise(async(resolve,reject)=>{console.log(this.prefix+'Обновляю инвентарь');await global.sc.wait();const arr=await global.xbsteam.getInventoryContexts(global.sc.steamID);const data=arr[0];const wallet=arr[1];global.xbot.updateAccountData(global.xbot.userdata,data,wallet);const invcontexts=Object.keys(data);for(const invc of invcontexts){await new Promise(async(resolve2,reject2)=>{await global.sc.wait();global.sc.getUserInventory(global.xbot.userdata.steamID,invc,2,false,function(e,inv,currency){if(e){reject2(e);return;}global.xbot.updateInventory(invc,inv);resolve2(data);});}).catch(function(e){console.log(e);}).then(function(data){console.log(global.xbot.prefix+invc+' updated');});}resolve();});}loop(tickCounter){return new Promise(async(resolve,reject)=>{try{if(!this.xbot_loggedIn){console.log(this.prefix+'Попытка авторизации');await this.auth().catch(await function(e){return new Promise(async resolve2=>{console.log(e.response?.data);console.log('Ошибка авторизации. Проверьте API ключ');await new Promise(resolve2=>setTimeout(resolve,global.data.tickDelay*2));resolve2();});});if(this.xbot_loggedIn){console.log(this.prefix+'Обновляю данные пользователя');await global.sc.wait();await global.sc.getSteamUser(sc.steamID,(err,user)=>{if(err){console.error('steam: Ошибка при получении информации о пользователе:');this.xbot_loggedIn=false;}else{user.steamID64=user.steamID.getSteamID64();global.xbot.userdata=user;}});}}if(this.xbot_loggedIn&&global.xbot.userdata!==null){if(tickCounter%global.data.ticks.checkConfirmations===0||global.data.needToSendConfirmations===true){console.log(this.prefix+'Проверяю аутентификатор');await this.sendConfirmations();global.data.needToSendConfirmations=false;await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}let authkey=SteamTotp.getAuthCode(global.data.sharedSecret);if(tickCounter%global.data.ticks.ping===0||this.lastsentauthkey!==authkey){await this.ping(authkey);}if(tickCounter%global.data.ticks.sendInventory===0||tickCounter===2){await this.processInventory();}if(tickCounter%global.data.ticks.sendOrders===0||tickCounter===2){console.log(this.prefix+'Проверяю ордера');await global.sc.wait();await global.xbsteam.getOrders().then(function(data){global.xbot.updateOrdersAndListings(data);});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}if(tickCounter%global.data.ticks.lastHistory===0||tickCounter===2){console.log(this.prefix+'Обновляю историю операций');var a=await global.xbsteam.getMarketHistory(0,100);this.history(a);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}const jobsResponse=await this.getJobs();const jobs=jobsResponse.jobs;console.log(this.prefix+'Получено '+jobs.length+' заданий');for(const job of jobs){await this.processJob(job);}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));resolve();}catch(ex){console.log(ex);reject(ex);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*25));}});}};